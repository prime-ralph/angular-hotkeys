/*! 
 * angular-hotkeys v1.7.1
 * https://chieffancypants.github.io/angular-hotkeys
 * Copyright (c) 2016 Wes Cruver
 * License: MIT
 */
"format global";"deps angular";!function(){"use strict";angular.module("cfp.hotkeys",[]).provider("hotkeys",["$injector",function(e){this.includeCheatSheet=!0,this.useNgRoute=e.has("ngViewDirective"),this.useUIRoute=e.has("uiViewDirective"),this.templateTitle="Keyboard Shortcuts:",this.templateHeader=null,this.templateFooter=null,this.template='<div class="cfp-hotkeys-container fade" ng-class="{in: helpVisible}" style="display: none;"><div class="cfp-hotkeys"><h4 class="cfp-hotkeys-title" ng-if="!header">{{ title }}</h4><div ng-bind-html="header" ng-if="header"></div><table><tbody><tr ng-repeat="hotkey in hotkeys | filter:{ description: \'!$$undefined$$\' }"><td class="cfp-hotkeys-keys"><span ng-repeat="key in hotkey.format() track by $index" ><span class="cfp-hotkeys-key" ng-repeat="skey in key track by $index">{{ skey }}</span><span ng-if="!$last">,&nbsp;</span></span></td><td class="cfp-hotkeys-text">{{ hotkey.description }}</td></tr></tbody></table><div ng-bind-html="footer" ng-if="footer"></div><div class="cfp-hotkeys-close" ng-click="toggleCheatSheet()">&#215;</div></div></div>',this.cheatSheetHotkey="?",this.cheatSheetDescription="Show / hide this help menu",this.$get=["$rootElement","$rootScope","$compile","$window","$document",function(e,t,n,o,i){function r(){k=!1}function a(){k=!0}function s(e){var t={command:"⌘",shift:"⇧",left:"←",right:"→",up:"↑",down:"↓","return":"⏎",backspace:"⌫"};e=e.split("+");for(var n=0;n<e.length;n++)"mod"===e[n]&&(o.navigator&&o.navigator.platform.indexOf("Mac")>=0?e[n]="command":e[n]="ctrl"),e[n]=t[e[n]]||e[n];return e.join(" + ")}function c(e,t,n,o,i,r){this.combo=e instanceof Array?e:[e],this.description=t,this.callback=n,this.action=o,this.allowIn=i,this.persistent=r,this._formated=null}function l(){for(var e=v.hotkeys.length;e--;){var t=v.hotkeys[e];t&&!t.persistent&&f(t)}}function u(){v.helpVisible=!v.helpVisible,v.helpVisible?(S=p("esc"),f("esc"),h("esc",S.description,u,null,["INPUT","SELECT","TEXTAREA"])):(f("esc"),S!==!1&&h(S))}function h(e,t,n,o,i,r){var a,s=["INPUT","SELECT","TEXTAREA"],l=Object.prototype.toString.call(e);if("[object Object]"===l&&(t=e.description,n=e.callback,o=e.action,r=e.persistent,i=e.allowIn,e=e.combo),f(e),t instanceof Function?(o=n,n=t,t="$$undefined$$"):angular.isUndefined(t)&&(t="$$undefined$$"),void 0===r&&(r=!0),"function"==typeof n){a=n,i instanceof Array||(i=[]);for(var u,h=0;h<i.length;h++)i[h]=i[h].toUpperCase(),u=s.indexOf(i[h]),-1!==u&&s.splice(u,1);n=function(e){var t=!0;if(e){var n=e.target||e.srcElement,o=n.nodeName.toUpperCase();if((" "+n.className+" ").indexOf(" mousetrap ")>-1)t=!0;else for(var i=0;i<s.length;i++)if(s[i]===o){t=!1;break}}t&&y(a.apply(this,arguments))}}"string"==typeof o?Mousetrap.bind(e,y(n),o):Mousetrap.bind(e,y(n));var p=new c(e,t,n,o,i,r);return v.hotkeys.push(p),p}function f(e){var t=e instanceof c?e.combo:e;if(Mousetrap.unbind(t),angular.isArray(t)){for(var n=!0,o=t.length;o--;)n=f(t[o])&&n;return n}var i=v.hotkeys.indexOf(p(t));return i>-1?(v.hotkeys[i].combo.length>1?v.hotkeys[i].combo.splice(v.hotkeys[i].combo.indexOf(t),1):(angular.forEach(m,function(e){var t=e.indexOf(v.hotkeys[i]);-1!==t&&e.splice(t,1)}),v.hotkeys.splice(i,1)),!0):!1}function p(e){if(!e)return v.hotkeys;for(var t,n=0;n<v.hotkeys.length;n++)if(t=v.hotkeys[n],t.combo.indexOf(e)>-1)return t;return!1}function d(e){return e.$id in m||(m[e.$id]=[],e.$on("$destroy",function(){for(var t=m[e.$id].length;t--;)f(m[e.$id].pop())})),{add:function(t){var n;return n=arguments.length>1?h.apply(this,arguments):h(t),m[e.$id].push(n),this}}}function y(e){return function(n,o){if(e instanceof Array){var i=e[0],r=e[1];e=function(e){r.$eval(i)}}t.$apply(function(){e(n,p(o))})}}var k=!0;Mousetrap.prototype.stopCallback=function(e,t){return k?(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:t.contentEditable&&"true"==t.contentEditable:!0},c.prototype.format=function(){if(null===this._formated){var e=this;e._formated=[],this.combo.forEach(function(t){for(var n=t.split(/[\s]/),o=0;o<n.length;o++)n[o]=s(n[o]);e._formated.push(n)})}return this._formated};var v=t.$new();v.hotkeys=[],v.helpVisible=!1,v.title=this.templateTitle,v.header=this.templateHeader,v.footer=this.templateFooter,v.toggleCheatSheet=u;var m={};if(this.useNgRoute&&t.$on("$routeChangeSuccess",function(e,t){l(),t&&t.hotkeys&&angular.forEach(t.hotkeys,function(e){var n=e[2];("string"==typeof n||n instanceof String)&&(e[2]=[n,t]),e[5]=!1,h.apply(this,e)})}),this.useUIRoute){var g=this;t.$on("$stateChangeSuccess",function(e,n,o,i,r){e.hotkeys=[];for(var a=n.$parent||n.parent||null,s=n.views&&Object.keys(n.$$state().views)||["@"];a&&"object"==typeof a;)a.hotkeys&&e.hotkeys.splice.apply(e.hotkeys,[0,0].concat(a.hotkeys)),a.views&&(s=s.concat(Object.keys(a.$$state().views))),a=a.$parent||a.parent||null;n.hotkeys&&e.hotkeys.splice.apply(e.hotkeys,[0,0].concat(n.hotkeys));var c=[];if(e.hotkeys)var l=e.hotkeys,u=function(){angular.forEach(l,function(e){var t=e[2];if("string"==typeof t||t instanceof String){var n=t.split(".")[0].trim();c.forEach(function(o){if(o[n]){var i=JSON.parse(JSON.stringify(e));i[2]=[t,o],i[5]=!1,d(o).add.apply(g,i)}})}})},h=t.$on("$viewContentLoaded",function(e,t){var n=s.indexOf(t);n>=0&&(c.push(e.targetScope||e.scope),s.splice(n,1),0===s.length&&(u(),h()))})})}if(this.includeCheatSheet){var b=i[0],$=e[0],w=angular.element(this.template);h(this.cheatSheetHotkey,this.cheatSheetDescription,u),($===b||$===b.documentElement)&&($=b.body),angular.element($).append(n(w)(v))}var S=!1,E={add:h,del:f,get:p,bindTo:d,template:this.template,toggleCheatSheet:u,includeCheatSheet:this.includeCheatSheet,cheatSheetHotkey:this.cheatSheetHotkey,cheatSheetDescription:this.cheatSheetDescription,useNgRoute:this.useNgRoute,useUIRoute:this.useUIRoute,purgeHotkeys:l,templateTitle:this.templateTitle,pause:r,unpause:a};return E}]}]).directive("hotkey",["hotkeys",function(e){return{restrict:"A",link:function(t,n,o){var i,r=[];angular.forEach(t.$eval(o.hotkey),function(t,n){i="string"==typeof o.hotkeyAllowIn?o.hotkeyAllowIn.split(/[\s,]+/):[],r.push(n),e.add({combo:n,description:o.hotkeyDescription,callback:t,action:o.hotkeyAction,allowIn:i})}),n.bind("$destroy",function(){angular.forEach(r,e.del)})}}}]).run(["hotkeys",function(e){}])}(),function(e,t,n){function o(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return v[e.which]?v[e.which]:m[e.which]?m[e.which]:String.fromCharCode(e.which).toLowerCase()}function r(e,t){return e.sort().join(",")===t.sort().join(",")}function a(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function s(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function c(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function l(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function u(){if(!k){k={};for(var e in v)e>95&&112>e||v.hasOwnProperty(e)&&(k[v[e]]=e)}return k}function h(e,t,n){return n||(n=u()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function f(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function p(e,t){var n,o,i,r=[];for(n=f(e),i=0;i<n.length;++i)o=n[i],b[o]&&(o=b[o]),t&&"keypress"!=t&&g[o]&&(o=g[o],r.push("shift")),l(o)&&r.push(o);return t=h(o,r,t),{key:o,modifiers:r,action:t}}function d(e,n){return null===e||e===t?!1:e===n?!0:d(e.parentNode,n)}function y(e){function n(e){e=e||{};var t,n=!1;for(t in b)e[t]?n=!0:b[t]=0;n||(S=!1)}function u(e,t,n,o,i,a){var s,c,u=[],h=n.type;if(!m._callbacks[e])return[];for("keyup"==h&&l(e)&&(t=[e]),s=0;s<m._callbacks[e].length;++s)if(c=m._callbacks[e][s],(o||!c.seq||b[c.seq]==c.level)&&h==c.action&&("keypress"==h&&!n.metaKey&&!n.ctrlKey||r(t,c.modifiers))){var f=!o&&c.combo==i,p=o&&c.seq==o&&c.level==a;(f||p)&&m._callbacks[e].splice(s,1),u.push(c)}return u}function h(e,t,n,o){m.stopCallback(t,t.target||t.srcElement,n,o)||e(t,n)===!1&&(s(t),c(t))}function f(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);if(t)return"keyup"==e.type&&$===t?void($=!1):void m.handleKey(t,a(e),e)}function d(){clearTimeout(g),g=setTimeout(n,1e3)}function k(e,t,o,r){function a(t){return function(){S=t,++b[e],d()}}function s(t){h(o,t,e),"keyup"!==r&&($=i(t)),setTimeout(n,10)}b[e]=0;for(var c=0;c<t.length;++c){var l=c+1===t.length,u=l?s:a(r||p(t[c+1]).action);v(t[c],u,r,e,c)}}function v(e,t,n,o,i){m._directMap[e+":"+n]=t,e=e.replace(/\s+/g," ");var r,a=e.split(" ");return a.length>1?void k(e,a,t,n):(r=p(e,n),m._callbacks[r.key]=m._callbacks[r.key]||[],u(r.key,r.modifiers,{type:r.action},o,e,i),void m._callbacks[r.key][o?"unshift":"push"]({callback:t,modifiers:r.modifiers,action:r.action,seq:o,level:i,combo:e}))}var m=this;if(e=e||t,!(m instanceof y))return new y(e);m.target=e,m._callbacks={},m._directMap={};var g,b={},$=!1,w=!1,S=!1;m._handleKey=function(e,t,o){var i,r=u(e,t,o),a={},s=0,c=!1;for(i=0;i<r.length;++i)r[i].seq&&(s=Math.max(s,r[i].level));for(i=0;i<r.length;++i)if(r[i].seq){if(r[i].level!=s)continue;c=!0,a[r[i].seq]=1,h(r[i].callback,o,r[i].combo,r[i].seq)}else c||h(r[i].callback,o,r[i].combo);var f="keypress"==o.type&&w;o.type!=S||l(e)||f||n(a),w=c&&"keydown"==o.type},m._bindMultiple=function(e,t,n){for(var o=0;o<e.length;++o)v(e[o],t,n)},o(e,"keypress",f),o(e,"keydown",f),o(e,"keyup",f)}for(var k,v={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},m={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},g={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},b={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},$=1;20>$;++$)v[111+$]="f"+$;for($=0;9>=$;++$)v[$+96]=$;y.prototype.bind=function(e,t,n){var o=this;return e=e instanceof Array?e:[e],o._bindMultiple.call(o,e,t,n),o},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:d(t,n.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.init=function(){var e=y(t);for(var n in e)"_"!==n.charAt(0)&&(y[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n))},y.init(),e.Mousetrap=y,"undefined"!=typeof module&&module.exports&&(module.exports=y),"function"==typeof define&&define.amd&&define(function(){return y})}(window,document);
